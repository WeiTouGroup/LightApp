nb.define({name:"nb.view.List",view:{},method:{onModelReady:function(e){var t=this;e.onChange({name:"items",scope:this,fn:function(t){var n,i,a=this,s=this.$(),o=t.data,c=e.getItemType,d=e.get("defaultItemType"),v=e.get("itemType"),m=nb.getType(v||"nb.view.List.Item"),l=!1,h=[],r=this._$itemList=[];s.empty(),s.scrollTop(0),s.scrollLeft(0),$.isArray(v)&&(l=!0),$.each(o,function(t,o){var b=m;l?b=nb.getType(v[t]):c&&(b=nb.getType(e.getItemType(t,o)||d||"nb.view.List.Item")),n=new b,h.push(n),n.setOpts(o),i=n.$(),i.attr("data-list-index",t),r.push(i),s.append(i),a.onItemReady(n)}),this.onItemsReady(h)}}),e.onChange({name:"activeIndex",scope:this,fn:function(e){t.onActiveIndexChange(e)}})},onActiveIndexChange:function(e){var t=e.origin,n=e.data,i=this.$(),a=this._$itemList;t>=0&&t<a.length&&a[t].removeClass("nb-v-active"),n>=0?(a[n].addClass("nb-v-active"),i.addClass("nb-v-active")):i.removeClass("nb-v-active")},onItemReady:function(e){},onItemsReady:function(e){}}}),nb.define({name:"nb.view.List.Item",view:{},method:{setOpts:function(e){this.parent(e),this.$().text(JSON.stringify(e))}}}),nb.define({name:"app.view.List.Item",view:{tag:"li","data-id":nb.bind("id"),$html:[{tag:"span",$text:nb.bind("name")}]}}),nb.define({name:"nb.view.Selector",view:{tag:"ul","class":"nb-v-selector"},method:{init:function(){var e=this,t=this.$();t.on("click",".nb-v-selector-item",function(n){var i=$(this),a=i.attr("data-index");e.getModel().set("activeIndex",a),t.addClass("nb-v-selector-active")}),t.on("click",".nb-v-close",function(n){var i=e.getModel();i.set("activeIndex",-1),t.removeClass("nb-v-selector-active"),n.stopImmediatePropagation()})},onModelReady:function(e){var t=this;e.onChange({name:"itemList",scope:this,fn:function(t){e.set("activeIndex",-1),this._setItemList(t.data)}}),e.onChange({name:"activeIndex",scope:this,fn:function(e){t.onActiveIndexChange(e)}})},onActiveIndexChange:function(e){var t=e.origin,n=e.data,i=this.$(),a=this._$itemList;t>=0&&a[t].removeClass("nb-v-selector-active"),n>=0?(a[n].addClass("nb-v-selector-active"),i.addClass("nb-v-selector-active")):i.removeClass("nb-v-selector-active")},_setItemList:function(e){var t=this.$(),n=this.getModel().get("itemType")||"app.view.Selector.Item",i=nb.getType(n),a=this._$itemList=[];if(!n)throw new Error("Can not find itemType for nb.bs.view.Switcher");t.empty(),e&&e.length&&$.each(e,function(e,n){var s=nb.getType(n.itemType||i),o=new s,c=o.$();o.setOpts(n),c.attr("data-index",e),c.addClass("nb-v-selector-item"),a.push(c),t.append(c)}),this.onItemsReady()},onItemsReady:function(){}}}),nb.define({name:"app.view.Selector.Item",view:{tag:"li","data-id":nb.bind("id"),$html:[{$name:"label",tag:"span","class":"nb-v-label",$text:nb.bind("name")},{$name:"btn",tag:"span","class":"nb-v-close",$html:"X"}]}});